---
title: "Week 11b Lab"
author: "Mac"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Instructions

Working with intertidal data. Today you will need to use skills that you have learned in working with words to clean up some issues with the character data and use what you learned today to reorder your factors into orders that make sense. (Also the column headers could be better...). HINT: New package idea to fix this is using the janitor package.

Your goal, as per usual, is to make a plot, any plot where one of the axes is a factor. Save everything in the appropriate folders.

You have two possible files to play with in the data folder (you don't HAVE to use both): intertidal.csv and intertidal_latitude.csv (as well as a data dictionary)

Importantly, if you decide to visualize anything by tide height it should go from low to mid to high tide.

Due Tuesday, 1pm.

# Load Libraries

```{r}
library(tidyverse)
library(here)
library(janitor)
library(patchwork)
```

# Load Data

```{r}
IntertidalData <- read_csv(here("Week_11","Data","intertidaldata.csv"))
IntertidalDataLatitude <- read_csv(here("Week_11","Data","intertidaldata_latitude.csv"))
IntertidalDataDictionary <- read_csv(here("Week_11","Data","intertidal_data_dictionary.csv"))
```

# Analyze Data

```{r}
View(IntertidalData)
View(IntertidalDataLatitude)
View(IntertidalDataDictionary)
```

## Join Data

```{r}
IntertidalDataComplete <- full_join(IntertidalData, IntertidalDataLatitude) %>% # Joined data to provide sites with corresponding latitudes
  relocate(Latitude, .after = Site) # Relocated Latitude to be after corresponding site

glimpse(IntertidalDataComplete)
```

## Clean Data

```{r}
IntertidalDataCompleteCleaned <- IntertidalDataComplete %>%
  clean_names() %>% # used Janitor to clean names of columns so they're easier to work with
  mutate(quadrat = fct_recode(quadrat, "Low" = "Low  .", "Mid" = "Mid  1"), # Fixed typos in some quadrat entries
         quadrat = factor(quadrat, levels = c("Low", "Mid", "High")), # Manually reordered quadrat levels
         site = fct_reorder(site, latitude)) # Reordered sites by latitude

glimpse(IntertidalDataCompleteCleaned)
```

```{r}
IntertidalDataCompleteCleanedPivoted <- IntertidalDataCompleteCleaned %>%
  pivot_longer(cols = bare_rock:anemone, names_to = "seafloor_cover", values_to = "percent_coverage")

glimpse(IntertidalDataCompleteCleanedPivoted)
```

```{r}
IntertidalDataCleaned <- IntertidalDataComplete %>%
  mutate(Quadrat = fct_recode(Quadrat, "Low" = "Low  .", "Mid" = "Mid  1"), # Fixed typos in some quadrat entries
         Quadrat = factor(Quadrat, levels = c("Low", "Mid", "High")), # Manually reordered quadrat levels
         Site = fct_reorder(Site, Latitude)) # Reordered sites by latitude

glimpse(IntertidalDataCleaned)
```

```{r}
IntertidalDataCleanedFork1 <- IntertidalDataCleaned %>%
  clean_names() # used Janitor to clean names of columns so they're easier to work with

glimpse(IntertidalDataCleanedFork1)
```

```{r}
IntertidalDataCleanedFork2 <- IntertidalDataCleaned %>%
  pivot_longer(cols = "Bare Rock":Anemone, names_to = "seafloor_cover", values_to = "percent_coverage")  %>%
  clean_names() # used Janitor to clean names of columns after pivoting

glimpse(IntertidalDataCleanedFork2)
```

## Plot Data

```{r}
intertidal_plot_algae <- IntertidalDataCleanedFork1 %>%
  ggplot(aes(x = quadrat, y = site, fill = algae)) +
  geom_tile() +
  scale_fill_viridis_c() +
  labs(title = "Algae Coverage",
       x = "Quadrat Tide Level",
       y = "Site",
       fill = "Coverage\n(%)")

intertidal_plot_algae
```

```{r}
intertidal_plot_seafloor_coverage <- IntertidalDataCleanedFork2 %>%
  ggplot(aes(y = seafloor_cover, x = quadrat, fill = percent_coverage)) +
  facet_wrap(~site, nrow = 3) +
  geom_tile() +
  scale_fill_viridis_c() +
  labs(title = "Seafloor Coverage by Site",
       y = NULL,
       x = "Quadrat Tide Level",
       fill = "Coverage\n(%)")

intertidal_plot_seafloor_coverage
```